<!DOCTYPE html>
<html>
<head>

<link rel="stylesheet" href="css/main.css" type="text/css">

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/jquery-ui.min.js"></script>

<script>
	game_size = 7;
	var peakA = 7;				// top level of tower A
	var peakB = 0;				// top level of tower B
	var peakC = 0;				// top level of tower C
	
	var pos = [];				// store the last position of each block in array pos
	for (var i = 0; i < (game_size); i++)
		pos['level' + i] = ['A', i];		// [0] current tower, [1] the current level.
	
	
	
 	$(function() {
	    $( ".draggable" ).draggable({containment: '#game'});
	    $( ".droppable" ).droppable({
	      drop: function( event, ui ) {
	        validateMove(event, ui, this.id)
	      }
	    });
	});
  
	function validateMove(event, ui, target)
	{
		object = detectObject(event);  	// detect object we are moving
		
		if (pos[object.id][0] == target)
			
		
		addToTower(object, target);	
	}
	
	function detectObject(event)
	{
		moving_obj = event.toElement;
		return moving_obj;	
	}
	
	function addToTower(object, target)
	{
		var peak
		
		switch (target) {
		case 'A':
			peak = peakA++;
			console.log('tower a now: ' + peakA);
			break; 
			
		case 'B':
			peak = peakB++;
			console.log('tower b now: ' + peakB);
			break;
			
		case 'C':
			peak = peakC++;
			console.log('tower c now: ' + peakC);
			break;
		}
		
		switch (object.title) {
		case 'A':
			peakA--;
			console.log('origin tower a now: ' + peakA);
			break;
		case 'B':
			peakB--;
			console.log('origin tower b now: ' + peakB);
			break;
		case 'C':
			peakC--;
			console.log('origin tower c now: ' + peakC);
			break;
		}
		
		destination_row = "" + target + peak;
		console.log('drop to' + destination_row);
		$('#' + destination_row).html(object);
		$('#' + object.id).css({'left': 0, 'top': 0});			// ensures image stays inside of <td>
		
		console.log(object.title);
		$('#' + object.id).attr('title', target);
	}
	
  </script>


</head>

<body>
	<div id='wrapper'>
	
		<div id='game'>
			<div id='tower1' class='tower' class='droppable'>
				<table id='A' class='droppable'> 
					<tr><td id='A7'></td></tr>
					<tr><td id='A6'><img id='level6' title='A' class='draggable' class='ui-state-highlight' src='img/level6.png'></td></tr>
					<tr><td id='A5'><img id='level5' title='A' class='draggable' class='ui-state-highlight' src='img/level5.png'></td></tr>
					<tr><td id='A4'><img id='level4' title='A' class='draggable' class='ui-state-highlight' src='img/level4.png'></td></tr>
					<tr><td id='A3'><img id='level3' title='A' class='draggable' class='ui-state-highlight' src='img/level3.png'></td></tr>
					<tr><td id='A2'><img id='level2' title='A' class='draggable' class='ui-state-highlight' src='img/level2.png'></td></tr>
					<tr><td id='A1'><img id='level1' title='A' class='draggable' class='ui-state-highlight' src='img/level1.png'></td></tr>
					<tr><td id='A0'><img id='level0' title='A' class='draggable' class='ui-state-highlight' src='img/level0.png'></td></tr>
				</table>
			</div>	
				
			<div id='tower2' class='tower'>
				<table id='B' class='droppable'> 
					<tr><td id='B7'></td></tr>
					<tr><td id='B6'></td></tr>
					<tr><td id='B5'></td></tr>
					<tr><td id='B4'></td></tr>
					<tr><td id='B3'></td></tr>
					<tr><td id='B2'></td></tr>
					<tr><td id='B1'></td></tr>
					<tr><td id='B0'></td></tr>
				</table>
			</div>
			
			<div id='tower3' class='tower'>
				<table id='C' class='droppable'> 
					<tr><td id='C7'></td></tr>
					<tr><td id='C6'></td></tr>
					<tr><td id='C5'></td></tr>
					<tr><td id='C4'></td></tr>
					<tr><td id='C3'></td></tr>
					<tr><td id='C2'></td></tr>
					<tr><td id='C1'></td></tr>
					<tr><td id='C0'></td></tr>
				</table>
			</div>	
		</div>
	
	</div>
</body>

</html>
